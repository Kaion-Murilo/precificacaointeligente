@model precificacaointeligente.Models.CramerModel

@{
    ViewData["Title"] = "Cálculo por Cramer – Comparação de Produtos";
}
<style>
    body {
        background: linear-gradient(135deg, #f4f6f8, #e5eaf4);
        font-family: 'Segoe UI', sans-serif;
        color: #2d2d2d;
    }

    h1, h4 {
        font-weight: 700;
    }

    /* ======= CARD PRINCIPAL ======= */
    .main-card {
        border-radius: 18px;
        box-shadow: 0 6px 25px rgba(0,0,0,0.1);
        padding: 2.5rem;
        transition: all 0.3s ease;
        background: white;
    }

        .main-card:hover {
            transform: scale(1.01);
        }

    /* ======= FORMULÁRIO ======= */
    label {
        color: #0d6efd;
        font-weight: 600;
    }

    .form-control {
        border-radius: 10px;
        padding: 0.75rem;
        border: 1.5px solid #cbd3da;
        transition: 0.3s;
    }

        .form-control:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.15rem rgba(13,110,253,.25);
        }

    .input-percent {
        position: relative;
    }

        .input-percent input {
            padding-right: 2rem;
        }

        .input-percent span {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
            font-weight: 600;
        }

    /* ======= BOTÃO ======= */
    .btn-gradient {
        background: linear-gradient(135deg, #0d6efd, #00bfa6);
        border: none;
        color: white;
        font-weight: 600;
        font-size: 1.1rem;
        padding: 0.9rem;
        border-radius: 12px;
        transition: 0.3s;
    }

        .btn-gradient:hover {
            opacity: 0.9;
            transform: scale(1.02);
        }

    /* ======= RESULTADOS ======= */
    .results-section h4 {
        color: #0d6efd;
        font-weight: 700;
    }

    .result-card {
        border-radius: 14px;
        transition: transform 0.3s;
        background: white;
        padding: 1.5rem;
        box-shadow: 0 4px 14px rgba(0,0,0,0.08);
        text-align: center;
    }

        .result-card:hover {
            transform: translateY(-5px);
        }

    .result-value {
        font-size: 2rem;
        font-weight: 700;
        color: #0d6efd;
    }

    /* ======= CANVAS ======= */
    canvas {
        background: white;
        border-radius: 14px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    /* ======= SEÇÃO DE CÁLCULOS ======= */
    .calc-steps {
        background: #f8fafc;
        border-left: 5px solid #0d6efd;
        border-radius: 10px;
        padding: 1.5rem;
        margin-top: 2.5rem;
        box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }

        .calc-steps h5 {
            color: #0d6efd;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .calc-steps code {
            background: #eef3ff;
            color: #333;
            padding: 0.35rem 0.65rem;
            border-radius: 6px;
            display: inline-block;
            margin: 0.25rem 0;
            font-family: "Consolas", monospace;
            font-size: 0.95rem;
        }

    /* ======= MATRIZES (NOVO E PREMIUM) ======= */
    .matrix-box {
        display: inline-block;
        background: white;
        padding: 18px;
        border-radius: 12px;
        border: 1.5px solid #d6ddeb;
        box-shadow: 0 3px 12px rgba(0,0,0,0.07);
        margin: 10px 0;
        font-family: "Consolas", monospace;
        font-size: 1rem;
        color: #2d2d2d;
    }

    .matrix-row {
        display: flex;
        justify-content: center;
        gap: 30px;
        padding: 4px 0;
    }

    .matrix-title {
        font-weight: 700;
        color: #0d6efd;
        margin-bottom: 0.3rem;
    }

    /* ======= BLOCOS DE FÓRMULAS ======= */
    .formula-block {
        background: #ffffff;
        border-radius: 10px;
        padding: 1.2rem;
        border: 1px solid #dbe3f2;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        font-family: "Consolas", monospace;
        white-space: pre-wrap;
        margin: 1rem 0;
        color: #333;
    }

    .formula-title {
        color: #0d6efd;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }
</style>


<h2 class="mb-4">Comparação de Produtos (Regra de Cramer)</h2>

<form method="post">

    <h4>Produto A</h4>
    <div class="row mb-3">
        <div class="col-md-4">
            <label>Preço (PriceA)</label>
            <input asp-for="PriceA" class="form-control" placeholder="Ex: 80" />
        </div>
        <div class="col-md-4">
            <label>Custo Variável (VariableCostA)</label>
            <input asp-for="VariableCostA" class="form-control" placeholder="Ex: 30" />
        </div>
        <div class="col-md-4">
            <label>Custo Fixo (FixedCostA)</label>
            <input asp-for="FixedCostA" class="form-control" placeholder="Ex: 20" />
        </div>
    </div>

    <h4>Produto B</h4>
    <div class="row mb-3">
        <div class="col-md-4">
            <label>Preço (PriceB)</label>
            <input asp-for="PriceB" class="form-control" placeholder="Ex: 100" />
        </div>
        <div class="col-md-4">
            <label>Custo Variável (VariableCostB)</label>
            <input asp-for="VariableCostB" class="form-control" placeholder="Ex: 20" />
        </div>
        <div class="col-md-4">
            <label>Custo Fixo (FixedCostB)</label>
            <input asp-for="FixedCostB" class="form-control" placeholder="Ex: 40" />
        </div>
    </div>

    <button type="submit" class="btn btn-primary mt-3">Calcular</button>

</form>


@if (Model.HasResult)
{
    <hr class="my-4" />

    <div class="row">
        <div class="col-md-6 mb-3">
            <div class="card p-3 shadow-sm">
                <h6>📊 Quantidade de Empate (Q)</h6>
                <h3 class="text-primary mb-0">@Math.Round(Model.Q) unidades</h3>
                <small class="text-muted">(arredondado)</small>
            </div>
        </div>

        <div class="col-md-6 mb-3">
            <div class="card p-3 shadow-sm">
                <h6>💰 Lucro no ponto de empate (L)</h6>
                <h3 class="text-success mb-0">R$ @Model.L.ToString("N2")</h3>
                <small class="text-muted">(arredondado)</small>
            </div>
        </div>
    </div>

    <h2>🧮 Passo a passo detalhado</h2>


    <!-- ================= PASSO 1 ================= -->
    <h3>1) Equações de partida</h3>

    <pre>
    Lucro_A = (PriceA - VariableCostA) · Q − FixedCostA
    Lucro_B = (PriceB - VariableCostB) · Q − FixedCostB

    A1 = PriceA - VariableCostA = @Model.A1
    A2 = PriceB - VariableCostB = @Model.A2
    C1 = FixedCostA = @Model.C1
    C2 = FixedCostB = @Model.C2
        </pre>


    <!-- ================= PASSO 2 ================= -->
    <h3>2) Montar a matriz dos coeficientes</h3>

    <pre>
    Matriz simbólica:
    | A1    -1 |
    | A2    -1 |

    Matriz substituída:
    | @Model.A1    -1 |
    | @Model.A2    -1 |
        </pre>


    <!-- ================= PASSO 3 ================= -->
    <h3>3) Determinante principal D</h3>

    <pre>
    D = A1·(-1) − (-1)·A2

    Substituindo:
    D = (@Model.A1 × -1) − (-1 × @Model.A2)
    D = @Model.D
        </pre>


    @if (Model.DeterminantZero)
    {
        <div class="alert alert-danger">
            <strong>D = 0.</strong> O sistema não possui solução única. A Regra de Cramer não pode ser aplicada.
        </div>
    }
    else
    {

        <!-- ================= PASSO 4 ================= -->
        <h3>4) Determinante Dx</h3>

        <pre>
        Matriz Dx simbólica:
        | C1    -1 |
        | C2    -1 |

        Matriz Dx substituída:
        | @Model.C1    -1 |
        | @Model.C2    -1 |

        Dx = (C1 × -1) − (-1 × C2)
        Dx = (@Model.C1 × -1) − (-1 × @Model.C2)
        Dx = @Model.Dx
                </pre>


        <!-- ================= PASSO 5 ================= -->
        <h3>5) Determinante DL</h3>

        <pre>
        Matriz DL simbólica:
        | A1    C1 |
        | A2    C2 |

        Matriz DL substituída:
        | @Model.A1    @Model.C1 |
        | @Model.A2    @Model.C2 |

        DL = (A1 × C2) − (C1 × A2)
        DL = (@Model.A1 × @Model.C2) − (@Model.C1 × @Model.A2)
        DL = @Model.Dl
                </pre>


        <!-- ================= PASSO 6 ================= -->
        <h3>6) Soluções finais</h3>

        <pre>
        Q = Dx / D = @Model.Dx / @Model.D = @Model.Q
        L = DL / D = @Model.Dl / @Model.D = @Model.L
                </pre>
    }
}
